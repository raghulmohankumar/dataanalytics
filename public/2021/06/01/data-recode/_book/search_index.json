[["_main.html", "Data_Recode 0.1 Import Relig-income.csv 0.2 Visualise using GGPLOT", " Data_Recode 2021-06-01 0.1 Import Relig-income.csv library(readxl) library(tidyverse) rel_inc &lt;- read_excel(&quot;relig-income.xlsx&quot;) rel_inc_long &lt;- rel_inc %&gt;% rename( religion = `Religious tradition`, n = `Sample Size` ) %&gt;% pivot_longer( cols = -c(religion, n), names_to = &quot;income&quot;, values_to = &quot;proportion&quot; ) %&gt;% mutate(frequency = round(proportion * n)) 0.2 Visualise using GGPLOT rel_inc_long &lt;- rel_inc_long %&gt;% mutate(religion = case_when( religion == &quot;Evangelical Protestant&quot; ~ &quot;Ev. Protestant&quot;, religion == &quot;Historically Black Protestant&quot; ~ &quot;Hist. Black Protestant&quot;, religion == &#39;Unaffiliated (religious &quot;nones&quot;)&#39; ~ &quot;Unaffiliated&quot;, TRUE ~ religion )) rel_inc_long &lt;- rel_inc_long %&gt;% mutate(religion = fct_rev(religion)) ggplot(rel_inc_long, aes(y = religion, x = frequency, fill = income)) + geom_col(position = &quot;fill&quot;) + scale_fill_viridis_d() + theme_minimal() ggplot(rel_inc_long, aes(y = religion, x = frequency, fill = income)) + geom_col(position = &quot;fill&quot;) + scale_fill_viridis_d() + theme_minimal() + theme(legend.position = &quot;bottom&quot;) ggplot(rel_inc_long, aes(y = religion, x = frequency, fill = income)) + geom_col(position = &quot;fill&quot;) + scale_fill_viridis_d() + theme_minimal() + theme(legend.position = &quot;bottom&quot;) + guides(fill = guide_legend(nrow = 2, byrow = TRUE)) ggplot(rel_inc_long, aes(y = religion, x = frequency, fill = income)) + geom_col(position = &quot;fill&quot;) + scale_fill_viridis_d() + theme_minimal() + theme(legend.position = &quot;bottom&quot;) + guides(fill = guide_legend(nrow = 2, byrow = TRUE)) + labs( x = &quot;Proportion&quot;, y = &quot;&quot;, title = &quot;Income distribution by religious group&quot;, subtitle = &quot;Source: Pew Research Center, Religious Landscape Study&quot;, fill = &quot;Income&quot; ) "]]
